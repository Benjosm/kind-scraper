#!/usr/bin/env node

import { Command } from 'commander';
import { scrapePage } from '../lib/scraper.js';

const program = new Command();

program.version('0.1.0');

program
  .command('scrape <url>')
  .description('Scrape a webpage for title and first 3 links')
  .action(async (url) => {
    try {
      const result = await scrapePage(url);
      console.log(JSON.stringify(result));
    } catch (error) {
      // Log the error message to stderr without exposing stack traces
      console.error(`Error: ${error.message}`);
      // Exit with non-zero code
      process.exit(1);
    }
  });

program.parse(process.argv);
